UAC-0020 (Vermin) атакує Сили оборони України з використанням ШПЗ SPECTR в тандемі з легітимним SyncThing (кампанія "SickSync") (CERT-UA#9934)

05.06.2024


ШПЗ

Загальна інформація

Урядовою командою реагування на комп'ютерні надзвичайні події України CERT-UA у безпосередній взаємодії з Центром кібербезпеки ЗСУ (ЦКБ) виявлено та досліджено активність угрупування UAC-0020 (Vermin), спрямовану у відношенні Сил оборони України.

Нагадаємо, що діяльність угрупування Vermin скеровується співробітниками силових відомств тимчасово окупованого Луганська та в останнє була помічена у березні 2022 року.

Цього разу у якості засобів реалізації кіберзагрози використано відомий з 2019 року інструментарій - шкідливе програмне забезпечення SPECTR. При цьому, для вивантаження з комп'ютера викрадних документів, файлів, паролів та іншої інформації використано штатний функціонал синхронізації легітимного програмного забезпечення SyncThing, яке, серед іншого, підтримує встановлення peer-to-peer з'єднання між комп'ютерами.

Для проведення кібератаки жертві надіслано електронний лист із вкладенням у вигляді архіву "туррель.фоп.вовчок.rar", захищеного паролем. В зазначеному архіві знаходиться RARSFX-архів "туррель.фоп.вовчок.sfx.rar.scr", що містить файл-приманку "Wowchok.pdf", ЕХЕ-інсталятор "sync.exe", створений за допомогою InnoSetup та BAT-файл "run_user.bat", призначений для первинного запуску. 

В свою чергу файл "sync.exe" містить як легітимні компоненти програми SyncThing, так і файли шкідливих програм SPECTR, в тому числі допоміжні бібліотеки та скрипти. При цьому, штатні файли програмного забезпечення SyncThing частково модифіковано з метою зміни назв каталогів, запланованих задач, відключення функціоналу відображення повідомлень користувачеві тощо.

Коротка інформація щодо модулів SPECTR наведена нижче.

SpecMon - викликає PluginLoader.dll, який, у свою чергу, забезпечить виконання всіх DLL-файлів, які містять клас "IPlugin".
Screengrabber - забезпечує виготовлення знімків екрану кожні 10 секунд за умови, якщо вікно програми містить такі назви: "word", "excel", "wps", "office", "notepad", "gram", "signal", "wickr", "wire", "threema", "viber", "whatsapp", "skype", "silence", "session", "adamant", "discord", "confide", "chrome", "mozilla", "edge", "vpn", "tor", "bat", "mail", "почта", "пошта", "диск", "disk", "drive", "box", "crypt", "wallet", "coin", "money", "подключение к", "remote", "1c:enterprise", "1с:предприятие", "1с предприятие", "1с-предприятие", "1cv", "faststone", "foxit", "pdf24 reader", "anydesk", "yandex with", "browser", "viewer".
FileGrabber - за допомогою robocopy.exe з каталогів %USERPROFILE%\{Desktop, MyPictures, Personal, Downloads, OneDrive} та %APPDATA%\DropBox здійснює копіювання файлів з розширеннями: ".one", ".pdf", ".doc", ".docx", ".docm", ".xls", ".xlsx", ".xlsm", ".ppt", ".pptx", ".odt", ".odm", ".ods", ".odp", ".cdr", ".jpg", ".png", ".bmp", ".eml", ".tiff", ".txt", ".zip", ".rar", ".7z"; додаткові аргументи: "/S /COPY:DT /R:3 /W:5 /XO /MAXAGE:%MAXAGE% /MAX:5242880".
Usb - за допомогою robocopy.exe зі знімних (USB) носіїв здійснює копіювання файлів з розширеннями: ".pdf", ".doc", ".docx", ".docm", ".xls", ".xlsx", ".xlsm", ".ppt", ".pptx", ".odt", ".odm", ".ods", ".odp", ".jpg", ".png", ".bmp", ".ogg", ".wav", ".mp3", ".mp4", ".txt", ".zip", ".rar", ".7z".
Social - здійснює викрадення конфігураційних (автентифікаційних) даних месенджерів: Telegram (tdata), Signal (databases, Session Storage, Local Storage, sql, config.json), Skype (Local Storage), Element (leveldb).
Browsers - здійснює викрадення даних (автентифікаційних даних, даних сесій, історії) Інтернет-браузерів браузерів: Firefox, Edge, Chrome (в т.ч., "Chromium", "Google", "Google(x86)", "Opera Software", "Amigo", "Orbitum", "Yandex", "Comodo", "Maxthon3", "Brave-Browser").
Слід зауважити, що викрадена інформація копіюється до підпапок в каталозі %APPDATA%\sync\Slave_Sync\, після чого, з використанням штатного функціоналу синхронізації легітимної програми SyncThing, вміст цих каталогів потрапляє на комп'ютер зловмисника, чим і забезпечується ексфільтрація даних.

З точки зору мережевих індикаторів (на випадок впевненості у не використанні згаданої технології санкціоновано), беручи до уваги встановлення peer-to-peer з'єднання, серед іншого, рекомендуємо звертати увагу на ознаки взаємодії з інфраструктурою SyncThing: *.syncthing.net.

Активність відстежується за ідентифікатором UAC-0020. 

Ураховуючи не дуже вдале повернення угрупування Vermin після тривалої відсутності в публічному просторі та з метою спрощення сприйняття інформації, виявленій кампанії надано назву "SickSync".

Осіб, відповідальних за кіберзахист ІКС ЗСУ, з метою мінімізації вірогідності реалізації кіберзагроз закликаємо невідкладно звернутися до Центру кібербезпеки ЗСУ (email: csoc@post.mil.gov.ua, Signal: +380673321891) з метою отримання та подальшого встановлення на всі без виключення ЕОМ відповідних технологій захисту. Крім того, просимо впевнитись у наявності налаштувань на граничних мережевих пристроях для передачі по протоколу Syslog журналів мережевих з'єднань.